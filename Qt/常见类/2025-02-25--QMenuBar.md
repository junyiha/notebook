---
category: Qt
date: 2025-01-24 09:00:00 +0800
layout: post
title: QMenuBar
tag: Qt-class
---
## æ‘˜è¦

+ QMenuBar ç±» ç›¸å…³å­¦ä¹ ç¬”è®°

<!--more-->

## Qt QMenuBarç±» è¯¦è§£

## **Qt `QMenuBar` ç±»è¯¦è§£**

`QMenuBar` æ˜¯ **Qt** ä¸­ç”¨äºåˆ›å»ºèœå•æ ï¼ˆMenu Barï¼‰çš„ç±»ï¼Œé€šå¸¸ç”¨äº **`QMainWindow`** ä½œä¸ºåº”ç”¨ç¨‹åºçš„å…¨å±€èœå•ã€‚å®ƒåŒ…å«å¤šä¸ª `QMenu`ï¼Œæ¯ä¸ª `QMenu` å†…å¯ä»¥åŒ…å«å¤šä¸ª `QAction` ä½œä¸ºèœå•é¡¹ã€‚

---

# **ğŸ“Œ 1. åŸºæœ¬ç”¨æ³•**
### **âœ… åˆ›å»ºèœå•æ å¹¶æ·»åŠ èœå•**
```cpp
#include <QApplication>
#include <QMainWindow>
#include <QMenuBar>
#include <QMenu>
#include <QAction>

class MainWindow : public QMainWindow {
public:
    MainWindow() {
        // åˆ›å»ºèœå•æ 
        QMenuBar *menuBar = new QMenuBar(this);
        
        // åˆ›å»º"æ–‡ä»¶"èœå•
        QMenu *fileMenu = new QMenu("æ–‡ä»¶(&F)", this);
        QAction *openAction = new QAction("æ‰“å¼€(&O)", this);
        QAction *exitAction = new QAction("é€€å‡º(&Q)", this);

        fileMenu->addAction(openAction);
        fileMenu->addSeparator();  // æ·»åŠ åˆ†å‰²çº¿
        fileMenu->addAction(exitAction);

        // åˆ›å»º"ç¼–è¾‘"èœå•
        QMenu *editMenu = new QMenu("ç¼–è¾‘(&E)", this);
        QAction *copyAction = new QAction("å¤åˆ¶(&C)", this);
        QAction *pasteAction = new QAction("ç²˜è´´(&V)", this);

        editMenu->addAction(copyAction);
        editMenu->addAction(pasteAction);

        // å°†èœå•æ·»åŠ åˆ°èœå•æ 
        menuBar->addMenu(fileMenu);
        menuBar->addMenu(editMenu);

        // è®¾ç½®èœå•æ åˆ°çª—å£
        this->setMenuBar(menuBar);

        // è¿æ¥ä¿¡å·æ§½
        connect(exitAction, &QAction::triggered, this, &MainWindow::close);
    }
};

int main(int argc, char *argv[]) {
    QApplication app(argc, argv);
    MainWindow window;
    window.show();
    return app.exec();
}
```
### **ğŸ“ ä»£ç è§£æ**
- `QMenuBar` è´Ÿè´£åˆ›å»ºèœå•æ ã€‚
- `QMenu` ç”¨äºåˆ›å»ºä¸‹æ‹‰èœå•ï¼Œå¦‚ **"æ–‡ä»¶"**ã€**"ç¼–è¾‘"**ã€‚
- `QAction` æ˜¯èœå•é¡¹ï¼Œå¦‚ **"æ‰“å¼€"**ã€**"é€€å‡º"**ã€‚
- `addSeparator()` æ·»åŠ åˆ†éš”çº¿ã€‚
- `setMenuBar(menuBar)` è®¾ç½®ä¸»çª—å£çš„èœå•æ ã€‚

---

# **ğŸ“Œ 2. `QMenuBar` çš„ä¸»è¦ API**
### **âœ… 2.1 æ·»åŠ èœå•**
```cpp
QMenu *fileMenu = menuBar->addMenu("æ–‡ä»¶(&F)");
```
- `&F` æ˜¯å¿«æ·é”® `Alt+F` è®¿é—®èœå•ã€‚

---

### **âœ… 2.2 æ·»åŠ èœå•é¡¹**
```cpp
QAction *newAction = fileMenu->addAction("æ–°å»º(&N)");
```
- `&N` æ˜¯å¿«æ·é”® `Alt+N` è®¿é—® **"æ–°å»º"**ã€‚

---

### **âœ… 2.3 æ·»åŠ å­èœå•**
```cpp
QMenu *subMenu = fileMenu->addMenu("å¯¼å‡º(&E)");
subMenu->addAction("å¯¼å‡º PDF");
subMenu->addAction("å¯¼å‡º PNG");
```
- è¿™æ · **"å¯¼å‡º"** å˜æˆäº† **å­èœå•**ã€‚

---

### **âœ… 2.4 è¿æ¥èœå•é¡¹çš„æ§½å‡½æ•°**
```cpp
connect(newAction, &QAction::triggered, this, &MainWindow::newFile);
```
- å½“ç‚¹å‡» **"æ–°å»º"** æ—¶ï¼Œä¼šè§¦å‘ `newFile()` å‡½æ•°ã€‚

---

### **âœ… 2.5 åˆ é™¤èœå•**
```cpp
menuBar->removeAction(fileMenu->menuAction());
```
- `removeAction()` å¯ä»¥åˆ é™¤èœå•ã€‚

---

# **ğŸ“Œ 3. ä½¿ç”¨å¿«æ·é”®**
### **âœ… 3.1 é€šè¿‡ `&` å®šä¹‰å¿«æ·é”®**
```cpp
QAction *saveAction = fileMenu->addAction("ä¿å­˜(&S)");
```
- `Alt + S` è§¦å‘ **"ä¿å­˜"**ã€‚

---

### **âœ… 3.2 é€šè¿‡ `QAction::setShortcut()` è®¾ç½®å¿«æ·é”®**
```cpp
saveAction->setShortcut(QKeySequence(Qt::CTRL + Qt::Key_S));
```
- `Ctrl + S` è§¦å‘ **"ä¿å­˜"**ã€‚

---

# **ğŸ“Œ 4. åœ¨ `QWidget` é‡Œä½¿ç”¨ `QMenuBar`**
å¦‚æœä½ çš„çª—å£ **ä¸æ˜¯ `QMainWindow`**ï¼Œå¯ä»¥æ‰‹åŠ¨æ·»åŠ  `QMenuBar`ï¼š
```cpp
QVBoxLayout *layout = new QVBoxLayout(this);
QMenuBar *menuBar = new QMenuBar(this);
QMenu *fileMenu = menuBar->addMenu("æ–‡ä»¶");
fileMenu->addAction("æ‰“å¼€");
layout->setMenuBar(menuBar);
```
- é€‚ç”¨äº **`QWidget`** ç•Œé¢ï¼Œè€Œä¸æ˜¯ `QMainWindow`ã€‚

---

# **ğŸ“Œ 5. Qt Designer æ–¹å¼**
1. **åœ¨ Qt Designer é‡Œæ‰“å¼€ `MainWindow.ui`**ã€‚
2. **æ‹–åŠ¨ `QMenuBar` åˆ°çª—å£é¡¶éƒ¨**ã€‚
3. **æ·»åŠ  `QMenu`ï¼ˆèœå•ï¼‰å’Œ `QAction`ï¼ˆèœå•é¡¹ï¼‰**ã€‚
4. **åŒå‡»èœå•é¡¹ â†’ è®¾ç½® `slot`ï¼ˆæ§½å‡½æ•°ï¼‰**ã€‚

---

# **ğŸ“Œ 6. QMenuBar ç›¸å…³ä¿¡å·**
### **âœ… `triggered(QAction*)`**
èœå•é¡¹è¢«ç‚¹å‡»æ—¶è§¦å‘ï¼š
```cpp
connect(menuBar, &QMenuBar::triggered, this, [](QAction *action) {
    qDebug() << "ä½ ç‚¹å‡»äº†ï¼š" << action->text();
});
```

### **âœ… `hovered(QAction*)`**
é¼ æ ‡æ‚¬åœåœ¨èœå•é¡¹ä¸Šæ—¶è§¦å‘ï¼š
```cpp
connect(menuBar, &QMenuBar::hovered, this, [](QAction *action) {
    qDebug() << "é¼ æ ‡æ‚¬åœï¼š" << action->text();
});
```

---

# **ğŸ“Œ 7. æ˜¾ç¤º / éšè—èœå•**
### **âœ… éšè—èœå•æ **
```cpp
menuBar->hide();
```
### **âœ… æ˜¾ç¤ºèœå•æ **
```cpp
menuBar->show();
```

---

# **ğŸ“Œ 8. å³é”®èœå•ï¼ˆ`QMenu`ï¼‰**
**å¯ä»¥ç»™ `QMenuBar` æˆ– `QWidget` æ·»åŠ å³é”®èœå•ï¼š**
```cpp
void MainWindow::contextMenuEvent(QContextMenuEvent *event) {
    QMenu contextMenu(this);
    contextMenu.addAction("å¤åˆ¶");
    contextMenu.addAction("ç²˜è´´");
    contextMenu.exec(event->globalPos());
}
```
- å³é”®æ—¶å¼¹å‡ºèœå•ã€‚

---

# **ğŸ”¥ æ€»ç»“**
âœ… `QMenuBar` ç”¨äºåˆ›å»ºèœå•æ ã€‚  
âœ… `QMenu` ç”¨äºåˆ›å»ºä¸‹æ‹‰èœå•ã€‚  
âœ… `QAction` æ˜¯èœå•é¡¹ï¼Œå¯è¿æ¥æ§½å‡½æ•°ã€‚  
âœ… `setShortcut()` è®¾å®šå¿«æ·é”®ã€‚  
âœ… é€‚ç”¨äº `QMainWindow`ï¼Œä½† `QWidget` ä¹Ÿå¯ä½¿ç”¨ã€‚  

`QMenuBar` æ˜¯ Qt åº”ç”¨ç¨‹åºä¸­ **èœå•æ ** çš„æ ¸å¿ƒç»„ä»¶ï¼ŒæŒæ¡å®ƒå¯ä»¥è®©ä½ çš„ç•Œé¢æ›´åŠ ä¸“ä¸šï¼ğŸš€