---
category: DeepLearning
date: 2025-05-12 09:00:00 +0800
layout: post
title: 模型训练
tag: AI部署
---
## 摘要

+ 模型训练

<!--more-->

## 模型训练流程

+ 安装python
  + python3.10.0

+ 安装 ultraytics
```cmd
# Install the ultralytics package from PyPI
pip install ultralytics
```

## 免费标注工具推荐

+ LabelImg(本地标注)
+ LabelMe(本地标注)

+ 安装标注工具
  + pip install labelImg
  + labelImg

+ 标注规范：
  + 标注框紧贴目标边缘
  + 遮挡目标需标注可见部分
  + 小目标(< 32x32)使用特殊标记

## 选择预训练模型

+ 官方提供的预训练权重
  + yolov12n.pt : 纳米级
  + yolov12s.pt : 轻量级
  + yolov12m.pt : 均衡版
  + yolov12l.pt : 大型版
  + yolov12x.pt : 超大型版

## 模型训练

```python
from ultralytics import YOLO

model = YOLO('yolov12s.pt')

results = model.train(
    data='dataset.yml',
    epochs=300,
    imgsz=640,
    batch=16,
    device=0,
    optimizer='SGD',
    lr0=0.001
)
```

+ 常用的模型训练参数和说明
  + model ： 指定用于训练的模型文件。接受指向.pt预训练模型或.yaml配置文件。对于定义模型结构或初始化权重至关重要
  + data ： 数据集配置文件的路径，例如coco8.yaml。该文件包含特定于数据集的参数，包括训练数据和验证数据的路径，类名和类数
  + epochs ：训练总轮数。每个epoch代表对整个数据集进行一次完整的训练。调整该值会影响训练时间和模型性能
  + patience ：在验证指标没有改善的情况下，提前停止训练所需的epoch数。当性能趋于平稳时停止训练，有助于防止过度拟合
  + batch ：批量大小，有三种模式：设置为整数，例如batch=16，60%GPU内存利用率的自动模式(batch=-1)，或指定利用率分数的自动模式(batch=0.70)
  + imgsz ：用于训练的目标图像尺寸。所有图像在输入模型前都会被调整到这一尺寸。影响模型精度和计算复杂度
  + device ： 指定用于训练的计算设备：单个GPU(device = 0)，多个GPU(device=0,1)，CPU(device=cpu)，或苹果芯片的MPS(device=mps)
  + workers ： 加载数据的工作线程数。影响数据预处理和输入模型的速度，尤其适用于多GPU设置
  + name ： 训练运行的名称。用于在项目文件内创建一个子目录，用于存储训练日志和输出结果。
  + pretrained ： 决定是否从预处理模型开始训练。可以是布尔值，也可以是加载权重的特定模型的字符串路径。提高训练效率和模型性能
  + optimizer ： 为训练模型选择优化器。选项包括SGD，Adam，AdamW，NAdam，RAdam，RMSProp等，或auto用于根据模型配置进行自动选择。影响收敛速度和稳定性
  + lr0 ： 初始学习率。调整这个值对优化过程至关重要，会影响模型权重的更新速度
  + lrf ： 最终学习率占初始学习率的百分比，与调度程序结合使用，随着时间的推移调整学习率。