---
category: OpenCV
date: 2025-06-05 09:00:00 +0800
layout: post
title: å¸¸ç”¨å‡½æ•°
tag: OpenCV
---
## ç®€ä»‹

+ OpenCV å¸¸ç”¨çš„å‡½æ•°

<!--more-->

## C++ OpenCV cv::addWeighted() è¯¦è§£

`cv::addWeighted()` æ˜¯ OpenCV ä¸­ä¸€ä¸ªéå¸¸å¸¸ç”¨çš„å‡½æ•°ï¼Œä¸»è¦ç”¨äº**å›¾åƒåŠ æƒèåˆï¼ˆå›¾åƒå åŠ ï¼‰**ï¼Œå¯ä»¥å°†ä¸¤å¼ å›¾åƒæŒ‰ç…§ä¸€å®šçš„æ¯”ä¾‹èåˆåœ¨ä¸€èµ·ï¼Œéå¸¸é€‚åˆå®ç°å›¾åƒé€æ˜å åŠ ã€æ°´å°ã€ç‰¹æ•ˆå¤„ç†ç­‰åŠŸèƒ½ã€‚

---

## ğŸ§  å‡½æ•°åŸå‹

```cpp
void cv::addWeighted(
    InputArray src1,  // ç¬¬ä¸€å¼ è¾“å…¥å›¾åƒ
    double alpha,     // ç¬¬ä¸€å¼ å›¾åƒçš„æƒé‡
    InputArray src2,  // ç¬¬äºŒå¼ è¾“å…¥å›¾åƒ
    double beta,      // ç¬¬äºŒå¼ å›¾åƒçš„æƒé‡
    double gamma,     // åŠ åˆ°æœ€ç»ˆç»“æœä¸Šçš„æ ‡é‡åç§»é‡
    OutputArray dst,  // è¾“å‡ºå›¾åƒ
    int dtype = -1    // è¾“å‡ºå›¾åƒçš„æ•°æ®ç±»å‹ï¼ˆå¯é€‰ï¼‰
);
```

---

## ğŸ“˜ æ•°å­¦å…¬å¼

`dst(i,j) = saturate( src1(i,j)*alpha + src2(i,j)*beta + gamma )`

* `alpha`ï¼šæ§åˆ¶ç¬¬ä¸€å¼ å›¾åƒçš„æƒé‡
* `beta`ï¼šæ§åˆ¶ç¬¬äºŒå¼ å›¾åƒçš„æƒé‡
* `gamma`ï¼šå¯¹èåˆç»“æœå¢åŠ äº®åº¦ï¼ˆå¯ä¸º 0ï¼‰
* `saturate()`ï¼šä¿è¯ç»“æœåœ¨åˆæ³•å›¾åƒèŒƒå›´ï¼ˆä¾‹å¦‚ `uint8` æ—¶æ˜¯ 0ï½255ï¼‰

---

## âœ… å‚æ•°è¯¦è§£

| å‚æ•°      | ç±»å‹        | è¯´æ˜                        |
| ------- | --------- | ------------------------- |
| `src1`  | `cv::Mat` | è¾“å…¥å›¾åƒ1ï¼ˆä¸ `src2` å°ºå¯¸å’Œç±»å‹å¿…é¡»ç›¸åŒï¼‰ |
| `alpha` | `double`  | å›¾åƒ1çš„æƒé‡                    |
| `src2`  | `cv::Mat` | è¾“å…¥å›¾åƒ2                     |
| `beta`  | `double`  | å›¾åƒ2çš„æƒé‡                    |
| `gamma` | `double`  | ç»“æœå›¾åƒçš„åç§»å€¼ï¼ˆå¯ä»¥ç†è§£ä¸ºäº®åº¦è°ƒæ•´ï¼‰       |
| `dst`   | `cv::Mat` | è¾“å‡ºå›¾åƒ                      |
| `dtype` | `int`     | è¾“å‡ºå›¾åƒçš„æ•°æ®ç±»å‹ï¼Œé»˜è®¤ `-1` è¡¨ç¤ºä¸è¾“å…¥ç›¸åŒ |

---

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹ï¼šå›¾åƒèåˆ

```cpp
#include <opencv2/opencv.hpp>
using namespace cv;

int main() {
    // è¯»å–ä¸¤å¼ å°ºå¯¸ç›¸åŒçš„å›¾åƒ
    Mat img1 = imread("image1.jpg");
    Mat img2 = imread("image2.jpg");

    // æ£€æŸ¥å›¾åƒæ˜¯å¦åŠ è½½æˆåŠŸ
    if (img1.empty() || img2.empty()) {
        std::cerr << "Failed to load images." << std::endl;
        return -1;
    }

    // ä¿è¯å›¾åƒå°ºå¯¸ä¸€è‡´
    resize(img2, img2, img1.size());

    // åŠ æƒèåˆï¼šalpha = 0.7, beta = 0.3
    Mat dst;
    double alpha = 0.7, beta = 0.3, gamma = 0;
    addWeighted(img1, alpha, img2, beta, gamma, dst);

    imshow("Blended Image", dst);
    waitKey(0);
    return 0;
}
```

---

## ğŸ§ª åº”ç”¨åœºæ™¯

1. **æ·»åŠ é€æ˜æ°´å°**ï¼š

   * é€šè¿‡è°ƒæ•´æ°´å°å›¾çš„ `alpha`ï¼Œå¯ä»¥å®ç°é€æ˜å åŠ ã€‚
2. **å›¾åƒå¯¹æ¯”èåˆ**ï¼š

   * ç”¨äºå¤šæ¨¡æ€å›¾åƒèåˆï¼ˆå¦‚çº¢å¤– + å¯è§å…‰ï¼‰ã€‚
3. **å›¾åƒè¿‡æ¸¡åŠ¨ç”»**ï¼š

   * åœ¨ä¸¤å¼ å›¾ä¹‹é—´é€æ­¥è°ƒæ•´ `alpha` å’Œ `beta` å®ç°æ¸å˜æ•ˆæœã€‚

---

## ğŸ§© æ³¨æ„äº‹é¡¹

* `src1` å’Œ `src2` å¿…é¡»å¤§å°ã€é€šé“æ•°ã€ç±»å‹ä¸€è‡´ï¼Œå¸¸è§ä¸º `CV_8UC3`ã€‚
* æƒé‡ `alpha + beta` ä¸ä¸€å®šå¿…é¡»ç­‰äº 1ï¼Œä½†è¿™æ ·åšå¯ä»¥æ›´å®¹æ˜“ç†è§£ã€‚
* èåˆç»“æœä¼šè‡ªåŠ¨è¿›è¡Œé¥±å’Œæˆªæ–­å¤„ç†ï¼ˆé¿å…åƒç´ å€¼æº¢å‡ºï¼‰ã€‚

---

## ğŸ“Œ æ‹“å±•ï¼šåŠ¨æ€èåˆåŠ¨ç”»ï¼ˆæ¸å˜ï¼‰

```cpp
for (double alpha = 0; alpha <= 1.0; alpha += 0.01) {
    double beta = 1.0 - alpha;
    Mat blended;
    addWeighted(img1, alpha, img2, beta, 0.0, blended);
    imshow("Blend Animation", blended);
    waitKey(30);
}
```

---

å¦‚ä½ è¿˜å¸Œæœ›å®ç° **å›¾åƒå åŠ æ—¶åŠ  mask æ©ç æ§åˆ¶åŒºåŸŸèåˆ** æˆ– **è‡ªå®šä¹‰æ··åˆå‡½æ•°**ï¼Œæˆ‘ä¹Ÿå¯ä»¥æä¾›ç›¸å…³ä»£ç ã€‚æ˜¯å¦éœ€è¦ï¼Ÿ
